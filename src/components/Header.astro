---
//src/components/Header.astro
const currentPath = Astro.url.pathname;
const isEnglish = currentPath.startsWith('/en');
const isTopPage = currentPath === "/" || currentPath === "/en/";

// ロケールに応じたベースパス
const basePath = isEnglish ? "/en" : "";

// トップページでは#リンク、他ページでは/付きリンクを使用
const profileLink = isTopPage ? `${basePath}#profile` : `${basePath}/#profile`;
const planLink = isTopPage ? `${basePath}#plan` : `${basePath}/#plan`;
const contactLink = isTopPage ? `${basePath}#contact` : `${basePath}/#contact`;

// 言語切替用URL生成
const getLanguageToggleUrl = () => {
  if (isEnglish) {
    // EN → JA: /en を削除
    return currentPath.replace(/^\/en(\/|$)/, '/') || '/';
  } else {
    // JA → EN: /en を追加
    return currentPath === '/' ? '/en/' : `/en${currentPath}`;
  }
};

const languageToggleUrl = getLanguageToggleUrl();
const currentLanguage = isEnglish ? 'EN' : 'JA';
const toggleLanguage = isEnglish ? 'JA' : 'EN';
---

<!-- sp-nav -->
<nav class="sp-nav" id="sp-nav" aria-label={isEnglish ? "Mobile Navigation" : "スマートフォン用ナビゲーション"}>
  <ul class="menu">
    <li class="menu__item">
      <a href={`${basePath}/`} class="menu__link">{isEnglish ? "Top" : "トップ"}</a>
    </li>
    <li class="menu__item">
      <a href={profileLink} class="menu__link">{isEnglish ? "Profile" : "プロフィール"}</a>
    </li>
    <li class="menu__item">
      <a href={`${basePath}/work-archive`} class="menu__link">{isEnglish ? "Works" : "制作実績"}</a>
    </li>
    <li class="menu__item">
      <a href={planLink} class="menu__link">{isEnglish ? "Plans" : "料金プラン"}</a>
    </li>
    <li class="menu__item">
      <a href={contactLink} class="menu__link">{isEnglish ? "Contact" : "お問い合わせ"}</a>
    </li>
    <li class="menu__item">
      <a href={languageToggleUrl} class="menu__link language-toggle">{toggleLanguage}</a>
    </li>
  </ul>
  <ul class="sp-sns" aria-label={isEnglish ? "SNS Links" : "SNSリンク"}>
    <li class="sp-sns__item">
      <a
        href="https://www.facebook.com/profile.php?id=100003251432034&locale=ja_JP"
        target="_blank"
        class="sp-sns__link"
        aria-label="facebook"
      >
        <picture>
          <source srcset="/assets/images/facebook.webp" type="image/webp" />
          <img
            src="/assets/images/facebook.png"
            width="32"
            height="32"
            loading="lazy"
            decoding="async"
            alt="facebook"
          />
        </picture>
      </a>
    </li>
    <li class="sp-sns__item">
      <a
        href="https://www.instagram.com/paimanpsycho/"
        target="_blank"
        class="sp-sns__link"
        aria-label="instagram"
      >
        <picture>
          <source srcset="/assets/images/instagram.webp" type="image/webp" />
          <img
            src="/assets/images/instagram.png"
            width="26"
            height="26"
            loading="lazy"
            decoding="async"
            alt="instagram"
          />
        </picture>
      </a>
    </li>
    <li class="sp-sns__item">
      <a
        href="https://x.com/dj_cherrrrryboy"
        target="_blank"
        class="sp-sns__link"
        aria-label="x"
      >
        <picture>
          <source srcset="/assets/images/x.webp" type="image/webp" />
          <img
            src="/assets/images/x.png"
            width="26"
            height="26"
            loading="lazy"
            decoding="async"
            alt="x"
          />
        </picture>
      </a>
    </li>
  </ul>
</nav>
<!-- humburger -->
<button
  class="hamburger-menu"
  id="js-hamburger-menu"
  aria-label="メニューを開く"
  aria-expanded="false"
  aria-controls="sp-nav"
>
  <span class="hamburger-menu__bar"></span>
  <span class="hamburger-menu__bar"></span>
  <span class="hamburger-menu__bar"></span>
</button>
<!-- header -->
<header class="header" id="header" role="banner">
  <div class="container">
    <a href="/" class="header-logo" aria-label={isEnglish ? "To Top Page" : "トップページへ"}>
      Dynamis
    </a>
    <nav class="header-nav" aria-label={isEnglish ? "Main Navigation" : "メインナビゲーション"}>
      <ul class="menu">
        <li class="menu__item">
          <a href={`${basePath}/`} class="menu__link">{isEnglish ? "Top" : "トップ"}</a>
        </li>
        <li class="menu__item">
          <a href={profileLink} class="menu__link">{isEnglish ? "Profile" : "プロフィール"}</a>
        </li>
        <li class="menu__item">
          <a href={`${basePath}/work-archive`} class="menu__link">{isEnglish ? "Works" : "制作実績"}</a>
        </li>
        <li class="menu__item">
          <a href={planLink} class="menu__link">{isEnglish ? "Plans" : "料金プラン"}</a>
        </li>
        <li class="menu__item">
          <a href={contactLink} class="menu__link">{isEnglish ? "Contact" : "お問い合わせ"}</a>
        </li>
        <li class="menu__item">
          <a href={languageToggleUrl} class="menu__link language-toggle">{toggleLanguage}</a>
        </li>
      </ul>
    </nav>
  </div>
</header>
